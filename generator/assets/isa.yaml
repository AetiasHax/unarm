options:
  version:
    description: The version of ARM to use
    kind: !version
  av:
    description: If true, r0-r3 and r4-11 will display as a1-a4 and v1-v8 respectively
    kind: !bool
  r9_use:
    description: How R9 should be displayed
    kind: !enum
      - name: r9
        description: General purpose register
      - name: sb
        description: Static base (SB), used for position-independent data
      - name: tr
        description: TLS register (TR), used for thread-local storage
  sl:
    description: If true, R10 will display as SL (stack limit)
    kind: !bool
  fp:
    description: If true, R11 will display as FP (frame pointer)
    kind: !bool
  ip:
    description: If true, R12 will display as IP (intra-procedure call scratch register)
    kind: !bool
  ual:
    description: If true, use Unified Assembly Language syntax (UAL), otherwise use divided syntax
    kind: !bool

versions:
- v4
- v4t
- v5
- v5t
- v5te
- v5tej
- v6k

types:
- name: s
  kind: !bool
- name: l
  kind: !bool
- name: wb
  kind: !bool
    write: "!"
- name: uimm
  kind: !uint bits(0..32)
- name: simm
  kind: !int bits(0..32)
- name: branch_target
  kind: !struct
    format: !fmt "#(addr)"
    fields:
    - name: addr
      kind: !uint pc + bits(0..32)
- name: blx_target
  kind: !enum
    bits: 0..28
    variants:
      1011_xxxx_xxxx_xxxx_xxxx_xxxx_xxxx:
        name: direct
        description: Direct target
        data:
          name: target
          kind: !type [branch_target, ((bits(0..24) << 2) | (bit(24) << 1)).sign_extend(6) + 8]
      0001_0010_1111_1111_1111_0011_xxxx:
        name: indirect
        description: Indirect target
        data:
          name: rm
          kind: !type [reg, bits(0..4)]
- name: cond
  kind: !enum
    bits: 0..4
    default: al
    variants:
      0000:
        name: eq
        description: Equal
      0001:
        name: ne
        description: Not equal
      0010:
        name: hs
        description: Unsigned higher or same
      0011:
        name: lo
        description: Unsigned lower
      0100:
        name: mi
        description: Minus/negative
      0101:
        name: pl
        description: Plus/positive
      0110:
        name: vs
        description: Overflow set
      0111:
        name: vc
        description: Overflow clear
      1000:
        name: hi
        description: Unsigned higher
      1001:
        name: ls
        description: Unsigned lower or same
      1010:
        name: ge
        description: Signed greater than or equal
      1011:
        name: lt
        description: Signed less than
      1100:
        name: gt
        description: Signed greater than
      1101:
        name: le
        description: Signed less than or equal
      1110:
        name: al
        description: Always
        format: !fmt ""
- name: reg
  kind: !enum
    bits: 0..4
    variants:
      0000:
        name: r0
        format: !if
          cond: option(av)
          then: !fmt a1
          else: !fmt r0
      0001:
        name: r1
        format: !if
          cond: option(av)
          then: !fmt a2
          else: !fmt r1
      0010:
        name: r2
        format: !if
          cond: option(av)
          then: !fmt a3
          else: !fmt r2
      0011:
        name: r3
        format: !if
          cond: option(av)
          then: !fmt a4
          else: !fmt r3
      0100:
        name: r4
        format: !if
          cond: option(av)
          then: !fmt v1
          else: !fmt r4
      0101:
        name: r5
        format: !if
          cond: option(av)
          then: !fmt v2
          else: !fmt r5
      0110:
        name: r6
        format: !if
          cond: option(av)
          then: !fmt v3
          else: !fmt r6
      0111:
        name: r7
        format: !if
          cond: option(av)
          then: !fmt v4
          else: !fmt r7
      1000:
        name: r8
        format: !if
          cond: option(av)
          then: !fmt v5
          else: !fmt r8
      1001:
        name: r9
        format: !if
          cond: option(r9_use) == enum_variant(r9_use, r9)
          then: !if
            cond: option(av)
            then: !fmt v6
            else: !fmt r9
          else: !if
            cond: option(r9_use) == enum_variant(r9_use, sb)
            then: !fmt sb
            else: !fmt tr
      1010:
        name: r10
        format: !if
          cond: option(sl)
          then: !fmt sl
          else: !if
            cond: option(av)
            then: !fmt v7
            else: !fmt r10
      1011:
        name: r11
        format: !if
          cond: option(fp)
          then: !fmt fp
          else: !if
            cond: option(av)
            then: !fmt v8
            else: !fmt r11
      1100:
        name: r12
        format: !if
          cond: option(ip)
          then: !fmt ip
          else: !fmt r12
      1101:
        name: sp
      1110:
        name: lr
      1111:
        name: pc
- name: shift_op
  kind: !enum
    bits: 0..2
    default: lsl
    variants:
      00:
        name: lsl
        description: Logical shift left
      01:
        name: lsr
        description: Logical shift right
      10:
        name: asr
        description: Arithmetic shift right
      11:
        name: ror
        description: Rotate right
- name: coproc
  kind: !enum
    bits: 0..4
    variants:
      0000:
        name: p0
      0001:
        name: p1
      0010:
        name: p2
      0011:
        name: p3
      0100:
        name: p4
      0101:
        name: p5
      0110:
        name: p6
      0111:
        name: p7
      1000:
        name: p8
      1001:
        name: p9
      1010:
        name: p10
      1011:
        name: p11
      1100:
        name: p12
      1101:
        name: p13
      1110:
        name: p14
      1111:
        name: p15
- name: co_reg
  kind: !enum
    bits: 0..4
    variants:
      0000:
        name: c0
      0001:
        name: c1
      0010:
        name: c2
      0011:
        name: c3
      0100:
        name: c4
      0101:
        name: c5
      0110:
        name: c6
      0111:
        name: c7
      1000:
        name: c8
      1001:
        name: c9
      1010:
        name: c10
      1011:
        name: c11
      1100:
        name: c12
      1101:
        name: c13
      1110:
        name: c14
      1111:
        name: c15
- name: op2
  kind: !enum
    bits: 0..32
    variants:
      xxxx_xx1x_xxxx_xxxx_xxxx_xxxx_xxxx_xxxx:
        name: imm
        description: Immediate
        format: !fmt "#(imm)"
        data:
          name: imm
          kind: !uint bits(0..8).rotate_right(bits(8..12) << 1)
      xxxx_xx0x_xxxx_xxxx_xxxx_xxxx_xxx1_xxxx:
        name: shift_reg
        description: Register shifted by register
        data:
          name: shift_reg
          kind: !struct
            format: !fmt (rm), (shift_op) (rs)
            fields:
            - name: rm
              kind: !type [reg, bits(0..4)]
            - name: shift_op
              kind: !type [shift_op, bits(5..7)]
            - name: rs
              kind: !type [reg, bits(8..12)]
      xxxx_xx0x_xxxx_xxxx_xxxx_xxxx_xxx0_xxxx:
        name: shift_imm
        description: Register shifted by immediate
        data:
          name: shift_imm
          kind: !struct
            format: !if
              cond: field(imm) == 0 && field(shift_op) == enum_variant(shift_op, lsl)
              then: !fmt (rm)
              else: !if
                cond: field(imm) == 0 && field(shift_op) == enum_variant(shift_op, ror)
                then: !fmt (rm), rrx
                else: !fmt "(rm), (shift_op) #(imm)"
            fields:
            - name: rm
              kind: !type [reg, bits(0..4)]
            - name: shift_op
              kind: !type [shift_op, bits(5..7)]
            - name: imm
              kind: !uint bits(7..12)
- name: cps_effect
  kind: !enum
    bits: 0..20
    variants:
      00:
        name: set_mode
        description: Set mode
        format: !fmt ""
      10:
        name: ie
        description: Interrupt enable
      11:
        name: id
        description: Interrupt disable
- name: aif_flags
  kind: !struct
    format: !fmt (a)(i)(f)
    fields:
    - name: a
      kind: !bool
        bits: 2
    - name: i
      kind: !bool
        bits: 1
    - name: f
      kind: !bool
        bits: 0
- name: addr_ldc_stc
  kind: !enum
    bits: 0..32
    variants:
      xxxx_xxx1_xxxx_xxxx_xxxx_xxxx_xxxx_xxxx:
        name: pre
        description: Pre-indexed
        data:
          name: addr_ldc_stc_pre
          kind: !struct
            format: !fmt "[(rn), #(offset)](writeback)"
            fields:
            - name: rn
              kind: !type [reg, bits(16..20)]
            - name: offset
              kind: !int (bits(0..8) << 2).negate_if(bit(23) == 0)
            - name: writeback
              kind: !type [wb, bit(21)]
      xxxx_xxx0_xx1x_xxxx_xxxx_xxxx_xxxx_xxxx:
        name: post
        description: Post-indexed
        data:
          name: addr_ldc_stc_post
          kind: !struct
            format: !fmt "[(rn)], #(offset)"
            fields:
            - name: rn
              kind: !type [reg, bits(16..20)]
            - name: offset
              kind: !int (bits(0..8) << 2).negate_if(bit(23) == 0)
      xxxx_xxx0_1x0x_xxxx_xxxx_xxxx_xxxx_xxxx:
        name: unidx
        description: Unindexed
        data:
          name: addr_ldc_stc_unidx
          kind: !struct
            format: !fmt "[(rn)], {(option)}"
            fields:
            - name: rn
              kind: !type [reg, bits(16..20)]
            - name: option
              kind: !uint bits(0..8)

opcodes:
- mnemonic: adc
  description: Add with Carry
  params: { s: s, cond: cond, rd: reg, rn: reg, op2: op2 }
  format:
    opcode: !if
      cond: option(ual)
      then: !fmt adc(s)(cond)
      else: !fmt adc(cond)(s)
    params: !fmt (rd), (rn), (op2)
  arm:
  - version: [v4*, v5*, v6*, v7]
    pattern: xxxx_00x0_101x_xxxx_xxxx_xxxx_xxxx_xxxx
    params: 
      s: !bits 20
      cond: !bits 28..32
      rd: !bits 12..16
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0001_01xx_xxxx
    params:
      s: !const 1
      rd: !bits 0..3
      rn: !bits 0..3
      op2: !enum [shift_imm, !struct { rm: !bits 3..6 }]

- mnemonic: add
  description: Add
  params: { s: s, cond: cond, rd: reg, rn: reg, op2: op2 }
  format:
    opcode: !if
      cond: option(ual)
      then: !fmt add(s)(cond)
      else: !fmt add(cond)(s)
    params: !fmt (rd), (rn), (op2)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_00x0_100x_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      s: !bits 20
      cond: !bits 28..32
      rd: !bits 12..16
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0001_110x_xxxx_xxxx
    params:
      s: !const 1
      rd: !bits 0..3
      rn: !bits 3..6
      op2: !enum [imm, !bits 6..9]
  - version: [v4t, v5t*, v6*]
    pattern: 0011_0xxx_xxxx_xxxx
    params:
      s: !const 1
      rd: !bits 8..11
      rn: !bits 8..11
      op2: !enum [imm, !bits 0..8]
  - version: [v4t, v5t*, v6*]
    pattern: 0001_100x_xxxx_xxxx
    params:
      s: !const 1
      rd: !bits 0..3
      rn: !bits 3..6
      op2: !enum [shift_imm, !struct { rm: !bits 6..9 }]
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0100_xxxx_xxxx
    params:
      rd: !expr (bit(7) << 3) | bits(0..3)
      rn: !expr (bit(7) << 3) | bits(0..3)
      op2: !enum [shift_imm, !struct { rm: !bits 3..7 }]
  - version: [v4t, v5t*, v6*]
    pattern: 1010_1xxx_xxxx_xxxx
    params:
      rd: !bits 8..11
      rn: !const 13 # sp
      op2: !enum [imm, !expr bits(0..8) << 2]
  - version: [v4t, v5t*, v6*]
    pattern: 1011_0000_0xxx_xxxx
    params:
      rd: !const 13 # sp
      rn: !const 13 # sp
      op2: !enum [imm, !expr bits(0..7) << 2]
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0100_x110_1xxx
    params:
      rd: !expr (bit(7) << 3) | bits(0..3)
      rn: !const 13 # sp
      op2: !enum [shift_imm, !struct { rm: !expr (bit(7) << 3) | bits(0..3) }]
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0100_1xxx_x101
    params:
      rd: !const 13 # sp
      rn: !const 13 # sp
      op2: !enum [shift_imm, !struct { rm: !bits 3..7 }]
  - version: [v4t, v5t*, v6*]
    pattern: 1010_0xxx_xxxx_xxxx
    params:
      rd: !bits 8..11
      rn: !const 15 # pc
      op2: !enum [imm, !expr bits(0..8) << 2]

- mnemonic: and
  description: Bitwise AND
  params: { s: s, cond: cond, rd: reg, rn: reg, op2: op2 }
  format:
    opcode: !if
      cond: option(ual)
      then: !fmt and(s)(cond)
      else: !fmt and(cond)(s)
    params: !fmt (rd), (rn), (op2)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_00x0_000x_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      s: !bits 20
      cond: !bits 28..32
      rd: !bits 12..16
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0000_00xx_xxxx
    params:
      s: !const 1
      rd: !bits 0..3
      rn: !bits 0..3
      op2: !enum [shift_imm, !struct { rm: !bits 3..6 }]

- mnemonic: b
  description: Branch
  params: { cond: cond, target: branch_target }
  format:
    opcode: !fmt b(cond)
    params: !fmt (target)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_1010_xxxx_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      cond: !bits 28..32
      target: !expr (bits(0..24) << 2).sign_extend(6) + 8
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 1101_xxxx_xxxx_xxxx
    params:
      cond: !bits 8..12
      target: !expr (bits(0..8) << 1).sign_extend(23) + 4
  - version: [v4t, v5t*, v6*]
    pattern: 1110_0xxx_xxxx_xxxx
    params:
      target: !expr (bits(0..11) << 1).sign_extend(20) + 4

- mnemonic: bic
  description: Bit Clear
  params: { s: s, cond: cond, rd: reg, rn: reg, op2: op2 }
  format:
    opcode: !if
      cond: option(ual)
      then: !fmt bic(s)(cond)
      else: !fmt bic(cond)(s)
    params: !fmt (rd), (rn), (op2)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_00x1_110x_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      s: !bits 20
      cond: !bits 28..32
      rd: !bits 12..16
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0011_10xx_xxxx
    params:
      s: !const 1
      rd: !bits 0..3
      rn: !bits 0..3
      op2: !enum [shift_imm, !struct { rm: !bits 3..6 }]

- mnemonic: bkpt
  description: Breakpoint
  params: { imm: uimm }
  format:
    opcode: !fmt bkpt
    params: !fmt "#(imm)"
  arm:
  - version: [v5t*, v6*]
    pattern: 1110_0001_0010_xxxx_xxxx_xxxx_0111_xxxx
    params:
      imm: !expr (bits(8..20) << 4) | bits(0..4)
  thumb:
  - version: [v5t*, v6*]
    pattern: 1011_1110_xxxx_xxxx
    params:
      imm: !bits 0..8

- mnemonic: bl
  description: Branch with Link
  params: { cond: cond, target: branch_target }
  format:
    opcode: !fmt bl(cond)
    params: !fmt (target)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_1011_xxxx_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      cond: !bits 28..32
      target: !expr (bits(0..24) << 2).sign_extend(6) + 8
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: [1111_0xxx_xxxx_xxxx, 11x1_xxxx_xxxx_xxxx]
    params:
      target: !expr ((bits(16..27) << 12) | (bits(0..11) << 1)).sign_extend(9) + 4

- mnemonic: blx
  description: Branch with Link and Exchange
  params: { cond: cond, target: blx_target }
  format:
    opcode: !fmt blx(cond)
    params: !fmt (target)
  arm:
  - version: [v5t*, v6*]
    pattern: 1111_101x_xxxx_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      target: !enum [direct, !expr ((bits(0..24) << 2) | (bit(24) << 1)).sign_extend(6) + 8]
  - version: [v5t*, v6*]
    pattern: xxxx_0001_0010_1111_1111_1111_0011_xxxx
    params:
      cond: !bits 28..32
      target: !enum [indirect, !bits 0..4]
  thumb:
  - version: [v5t*, v6*]
    pattern: [1111_0xxx_xxxx_xxxx, 11x0_xxxx_xxxx_xxxx]
    params:
      target: !enum [direct, !expr ((bits(16..27) << 12) | (bits(1..11) << 2)).sign_extend(9) + 4]
  - version: [v5t*, v6*]
    pattern: 0100_0111_1xxx_x000
    params:
      target: !enum [indirect, !bits 3..7]

- mnemonic: bx
  description: Branch and Exchange
  params: { cond: cond, rm: reg }
  format:
    opcode: !fmt bx(cond)
    params: !fmt (rm)
  arm:
  - version: [v4t, v5t*, v6*]
    pattern: xxxx_0001_0010_1111_1111_1111_0001_xxxx
    params:
      cond: !bits 28..32
      rm: !bits 0..4
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0111_0xxx_x000
    params:
      rm: !bits 3..7

- mnemonic: bxj
  description: Branch and Exchange Jazelle
  params: { cond: cond, rm: reg }
  format:
    opcode: !fmt bxj(cond)
    params: !fmt (rm)
  arm:
  - version: [v5tej, v6*]
    pattern: xxxx_0001_0010_1111_1111_1111_0010_xxxx
    params:
      cond: !bits 28..32
      rm: !bits 0..4

- mnemonic: cdp
  description: Coprocessor Data Processing
  params: { cond: cond, coproc: coproc, opc1: uimm, crd: co_reg, crn: co_reg, crm: co_reg, opc2: uimm }
  format:
    opcode: !fmt cdp(cond)
    params: !fmt "(coproc), #(opc1), (crd), (crn), (crm), #(opc2)"
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_1110_xxxx_xxxx_xxxx_xxxx_xxx0_xxxx
    params:
      cond: !bits 28..32
      coproc: !bits 8..12
      opc1: !bits 20..24
      crd: !bits 12..16
      crn: !bits 16..20
      crm: !bits 0..4
      opc2: !bits 5..8

- mnemonic: cdp2
  description: Coprocessor Data Processing (extended)
  params: { coproc: coproc, opc1: uimm, crd: co_reg, crn: co_reg, crm: co_reg, opc2: uimm }
  format:
    opcode: !fmt cdp2
    params: !fmt "(coproc), #(opc1), (crd), (crn), (crm), #(opc2)"
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: 1111_1110_xxxx_xxxx_xxxx_xxxx_xxx0_xxxx
    params:
      cond: !bits 28..32
      coproc: !bits 8..12
      opc1: !bits 20..24
      crd: !bits 12..16
      crn: !bits 16..20
      crm: !bits 0..4
      opc2: !bits 5..8

- mnemonic: clrex
  description: Clear Exclusive
  params: {}
  format:
    opcode: !fmt clrex
    params: !fmt ""
  arm:
  - version: [v6k]
    pattern: 1111_0101_0111_1111_1111_0000_0001_1111
    params: {}

- mnemonic: clz
  description: Count Leading Zeros
  params: { cond: cond, rd: reg, rm: reg }
  format:
    opcode: !fmt clz(cond)
    params: !fmt (rd), (rm)
  arm:
  - version: [v5t*, v6*]
    pattern: xxxx_0001_0110_1111_xxxx_1111_0001_xxxx
    params:
      cond: !bits 28..32
      rd: !bits 12..16
      rm: !bits 0..4

- mnemonic: cmn
  description: Compare Negative
  params: { cond: cond, rn: reg, op2: op2 }
  format:
    opcode: !fmt cmn(cond)
    params: !fmt (rn), (op2)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_00x1_0111_xxxx_0000_xxxx_xxxx_xxxx
    params:
      cond: !bits 28..32
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0010_11xx_xxxx
    params:
      rn: !bits 0..3
      op2: !enum [shift_imm, !struct { rm: !bits 3..6 }]

- mnemonic: cmp
  description: Compare
  params: { cond: cond, rn: reg, op2: op2 }
  format:
    opcode: !fmt cmp(cond)
    params: !fmt (rn), (op2)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_00x1_0101_xxxx_0000_xxxx_xxxx_xxxx
    params:
      cond: !bits 28..32
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0010_1xxx_xxxx_xxxx
    params:
      rn: !bits 8..11
      op2: !enum [imm, !bits 0..8]
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0010_10xx_xxxx
    params:
      rn: !bits 0..3
      op2: !enum [shift_imm, !struct { rm: !bits 3..6 }]
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0101_xxxx_xxxx
    params:
      rn: !expr (bit(7) << 3) | bits(0..3)
      op2: !enum [shift_imm, !struct { rm: !bits 3..7 }]

- mnemonic: cps
  description: Change Processor State
  params: { effect: cps_effect, aif: aif_flags, mode: uimm }
  format:
    opcode: !fmt cps(effect)
    params: !if
      cond: field(effect) == enum_variant(cps_effect, set_mode)
      then: !fmt "#(mode)"
      else: !if
        cond: field(mode) == 0
        then: !fmt (aif)
        else: !fmt "(aif), #(mode)"
  arm:
  - version: [v6*]
    pattern: 1111_0001_0000_xxx0_0000_000x_xx0x_xxxx
    params:
      effect: !bits 18..20
      aif: !bits 6..9
      mode: !bits 0..5
  thumb:
  - version: [v6*]
    pattern: 1011_0110_011x_0xxx
    params:
      effect: !bits 4..6
      aif: !bits 0..3

- mnemonic: csdb
  description: Consume of Speculative Data Barrier
  params: { cond: cond }
  format:
    opcode: !fmt csdb(cond)
    params: !fmt ""
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_0011_0010_0000_1111_0000_0001_0100
    params:
      cond: !bits 28..32

- mnemonic: eor
  description: Bitwise Exclusive OR
  params: { s: s, cond: cond, rd: reg, rn: reg, op2: op2 }
  format:
    opcode: !if
      cond: option(ual)
      then: !fmt eor(s)(cond)
      else: !fmt eor(cond)(s)
    params: !fmt (rd), (rn), (op2)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_00x0_001x_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      s: !bits 20
      cond: !bits 28..32
      rd: !bits 12..16
      rn: !bits 16..20
      op2: !bits 0..32
  thumb:
  - version: [v4t, v5t*, v6*]
    pattern: 0100_0000_01xx_xxxx
    params:
      s: !const 1
      rd: !bits 0..3
      rn: !bits 0..3
      op2: !enum [shift_imm, !struct { rm: !bits 3..6 }]

- mnemonic: ldc
  description: Load Coprocessor
  params: { l: l, cond: cond, coproc: coproc, crd: co_reg, dest: addr_ldc_stc }
  format:
    opcode: !if
      cond: option(ual)
      then: !fmt ldc(l)(cond)
      else: !fmt ldc(cond)(l)
    params: !fmt (coproc), (crd), (dest)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: xxxx_110x_xxx1_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      l: !bits 22
      cond: !bits 28..32
      coproc: !bits 8..12
      crd: !bits 12..16
      dest: !bits 0..32

- mnemonic: ldc2
  description: Load Coprocessor (extended)
  params: { l: l, coproc: coproc, crd: co_reg, dest: addr_ldc_stc }
  format:
    opcode: !fmt ldc2(l)
    params: !fmt (coproc), (crd), (dest)
  arm:
  - version: [v4*, v5t*, v6*]
    pattern: 1111_110x_xxx1_xxxx_xxxx_xxxx_xxxx_xxxx
    params:
      l: !bits 22
      coproc: !bits 8..12
      crd: !bits 12..16
      dest: !bits 0..32
